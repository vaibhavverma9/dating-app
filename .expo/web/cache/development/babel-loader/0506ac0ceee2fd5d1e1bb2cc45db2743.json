{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport { useAppState } from '@react-native-community/hooks';\nimport { useEffect, useState, useRef } from 'react';\nimport * as Updates from 'expo-updates';\nimport Platform from \"react-native-web/dist/exports/Platform\";\nexport var useExpoOta = function useExpoOta() {\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      updating = _useState2[0],\n      setUpdating = _useState2[1];\n\n  var currentAppState = useAppState();\n  var isUpdating = useRef(false);\n  useEffect(function () {\n    if (!__DEV__ && currentAppState === 'active' && Platform.OS !== 'web' && !isUpdating.current) {\n      var update = function update() {\n        var _update;\n\n        return _regeneratorRuntime.async(function update$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return _regeneratorRuntime.awrap(Updates.checkForUpdateAsync());\n\n              case 3:\n                _update = _context.sent;\n\n                if (!(_update == null ? void 0 : _update.isAvailable)) {\n                  _context.next = 13;\n                  break;\n                }\n\n                isUpdating.current = true;\n                setUpdating(true);\n                _context.next = 9;\n                return _regeneratorRuntime.awrap(Updates.fetchUpdateAsync());\n\n              case 9:\n                _context.next = 11;\n                return _regeneratorRuntime.awrap(Updates.reloadAsync());\n\n              case 11:\n                setUpdating(false);\n                isUpdating.current = false;\n\n              case 13:\n                _context.next = 20;\n                break;\n\n              case 15:\n                _context.prev = 15;\n                _context.t0 = _context[\"catch\"](0);\n                setUpdating(false);\n                isUpdating.current = false;\n                console.error('ðŸ‘‹ op, the expo update failed', _context.t0);\n\n              case 20:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, null, null, [[0, 15]], Promise);\n      };\n\n      update();\n    }\n  }, [currentAppState]);\n  return {\n    updating: updating\n  };\n};","map":{"version":3,"sources":["/Users/vaibhavverma9/Desktop/realtalk-app/dating-app/app/hooks/use-expo-ota.tsx"],"names":["useAppState","useEffect","useState","useRef","Updates","useExpoOta","updating","setUpdating","currentAppState","isUpdating","__DEV__","Platform","OS","current","update","checkForUpdateAsync","isAvailable","fetchUpdateAsync","reloadAsync","console","error"],"mappings":";;AAAA,SAASA,WAAT,QAA4B,+BAA5B;AACA,SAASC,SAAT,EAAoBC,QAApB,EAA8BC,MAA9B,QAA4C,OAA5C;AACA,OAAO,KAAKC,OAAZ,MAAyB,cAAzB;;AAGA,OAAO,IAAMC,UAAU,GAAG,SAAbA,UAAa,GAAM;AAAA,kBACEH,QAAQ,CAAC,KAAD,CADV;AAAA;AAAA,MACvBI,QADuB;AAAA,MACbC,WADa;;AAE9B,MAAMC,eAAuB,GAAGR,WAAW,EAA3C;AACA,MAAMS,UAAU,GAAGN,MAAM,CAAC,KAAD,CAAzB;AAEAF,EAAAA,SAAS,CAAC,YAAM;AACd,QACE,CAACS,OAAD,IACAF,eAAe,KAAK,QADpB,IAEAG,QAAQ,CAACC,EAAT,KAAgB,KAFhB,IAGA,CAACH,UAAU,CAACI,OAJd,EAKE;AACA,UAAMC,MAAM,GAAG,SAATA,MAAS;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iDAEUV,OAAO,CAACW,mBAAR,EAFV;;AAAA;AAELD,gBAAAA,OAFK;;AAAA,sBAGPA,OAHO,oBAGPA,OAAM,CAAEE,WAHD;AAAA;AAAA;AAAA;;AAITP,gBAAAA,UAAU,CAACI,OAAX,GAAqB,IAArB;AACAN,gBAAAA,WAAW,CAAC,IAAD,CAAX;AALS;AAAA,iDAMHH,OAAO,CAACa,gBAAR,EANG;;AAAA;AAAA;AAAA,iDAOHb,OAAO,CAACc,WAAR,EAPG;;AAAA;AAQTX,gBAAAA,WAAW,CAAC,KAAD,CAAX;AACAE,gBAAAA,UAAU,CAACI,OAAX,GAAqB,KAArB;;AATS;AAAA;AAAA;;AAAA;AAAA;AAAA;AAYXN,gBAAAA,WAAW,CAAC,KAAD,CAAX;AACAE,gBAAAA,UAAU,CAACI,OAAX,GAAqB,KAArB;AACAM,gBAAAA,OAAO,CAACC,KAAR,CAAc,+BAAd;;AAdW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAf;;AAiBAN,MAAAA,MAAM;AACP;AACF,GA1BQ,EA0BN,CAACN,eAAD,CA1BM,CAAT;AA4BA,SAAO;AACLF,IAAAA,QAAQ,EAARA;AADK,GAAP;AAGD,CApCM","sourcesContent":["import { useAppState } from '@react-native-community/hooks'\nimport { useEffect, useState, useRef } from 'react'\nimport * as Updates from 'expo-updates'\nimport { Platform } from 'react-native'\n\nexport const useExpoOta = () => {\n  const [updating, setUpdating] = useState(false)\n  const currentAppState: string = useAppState()\n  const isUpdating = useRef(false)\n\n  useEffect(() => {\n    if (\n      !__DEV__ &&\n      currentAppState === 'active' &&\n      Platform.OS !== 'web' &&\n      !isUpdating.current\n    ) {\n      const update = async () => {\n        try {\n          const update = await Updates.checkForUpdateAsync()\n          if (update?.isAvailable) {\n            isUpdating.current = true\n            setUpdating(true)\n            await Updates.fetchUpdateAsync()\n            await Updates.reloadAsync()\n            setUpdating(false)\n            isUpdating.current = false\n          }\n        } catch (e) {\n          setUpdating(false)\n          isUpdating.current = false\n          console.error('ðŸ‘‹ op, the expo update failed', e)\n        }\n      }\n      update()\n    }\n  }, [currentAppState])\n\n  return {\n    updating,\n  }\n}"]},"metadata":{},"sourceType":"module"}