{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/Users/vaibhavverma9/Desktop/realtalk-app/dating-app/app/components/videosPage/EditLocationView.tsx\";\nimport React, { useEffect, useState, useContext } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { colors } from \"../../styles/colors\";\nimport * as Location from 'expo-location';\nimport { _storeLatitude, _storeLongitude, _storeCity, _storeRegion } from \"../../utils/asyncStorage\";\nimport { UPDATE_CITY, UPDATE_REGION } from \"../../utils/graphql/GraphqlClient\";\nimport { useMutation } from '@apollo/client';\nimport { UserIdContext } from \"../../utils/context/UserIdContext\";\nexport default function EditLocationView(props) {\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      locationServices = _useState2[0],\n      setLocationServices = _useState2[1];\n\n  var _useState3 = useState(props.route.params.city),\n      _useState4 = _slicedToArray(_useState3, 2),\n      city = _useState4[0],\n      setCity = _useState4[1];\n\n  var _useState5 = useState(props.route.params.region),\n      _useState6 = _slicedToArray(_useState5, 2),\n      region = _useState6[0],\n      setRegion = _useState6[1];\n\n  var _useMutation = useMutation(UPDATE_CITY),\n      _useMutation2 = _slicedToArray(_useMutation, 2),\n      updateCity = _useMutation2[0],\n      updateCityData = _useMutation2[1].updateCityData;\n\n  var _useMutation3 = useMutation(UPDATE_REGION),\n      _useMutation4 = _slicedToArray(_useMutation3, 2),\n      updateRegion = _useMutation4[0],\n      updateRegionData = _useMutation4[1].updateRegionData;\n\n  var _useContext = useContext(UserIdContext),\n      _useContext2 = _slicedToArray(_useContext, 2),\n      userId = _useContext2[0],\n      setUserId = _useContext2[1];\n\n  var _useState7 = useState('Set your location'),\n      _useState8 = _slicedToArray(_useState7, 2),\n      buttonText = _useState8[0],\n      setButtonText = _useState8[1];\n\n  useEffect(function () {\n    checkLocation();\n  }, []);\n\n  function checkLocation() {\n    return _regeneratorRuntime.async(function checkLocation$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            (function _callee() {\n              var _await$Location$getPe, status;\n\n              return _regeneratorRuntime.async(function _callee$(_context) {\n                while (1) {\n                  switch (_context.prev = _context.next) {\n                    case 0:\n                      _context.next = 2;\n                      return _regeneratorRuntime.awrap(Location.getPermissionsAsync());\n\n                    case 2:\n                      _await$Location$getPe = _context.sent;\n                      status = _await$Location$getPe.status;\n\n                      if (status !== 'granted') {\n                        setLocationServices(false);\n                        setButtonText('Set your location');\n                      } else {\n                        setLocationServices(true);\n                        setButtonText('Update current location');\n                      }\n\n                    case 5:\n                    case \"end\":\n                      return _context.stop();\n                  }\n                }\n              }, null, null, null, Promise);\n            });\n\n            if (city && region && city != '' && region != '') {\n              setLocationServices(true);\n              setButtonText('Update current location');\n            }\n\n          case 2:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  var enableLocation = function enableLocation() {\n    (function _callee2() {\n      var _await$Location$reque, status, location, latitude, longitude, postalAddress, _city, _region, point;\n\n      return _regeneratorRuntime.async(function _callee2$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return _regeneratorRuntime.awrap(Location.requestPermissionsAsync());\n\n            case 2:\n              _await$Location$reque = _context3.sent;\n              status = _await$Location$reque.status;\n\n              if (!(status == 'granted')) {\n                _context3.next = 26;\n                break;\n              }\n\n              setLocationServices(true);\n              setButtonText('Updated to current location');\n              _context3.next = 9;\n              return _regeneratorRuntime.awrap(Location.getCurrentPositionAsync({}));\n\n            case 9:\n              location = _context3.sent;\n              latitude = location.coords.latitude;\n              longitude = location.coords.longitude;\n              _context3.next = 14;\n              return _regeneratorRuntime.awrap(Location.reverseGeocodeAsync({\n                latitude: latitude,\n                longitude: longitude\n              }));\n\n            case 14:\n              postalAddress = _context3.sent;\n              _city = postalAddress[0].city;\n              _region = postalAddress[0].region;\n              setCity(_city);\n              setRegion(_region);\n\n              _storeCity(_city);\n\n              _storeRegion(_region);\n\n              _storeLatitude(latitude);\n\n              _storeLongitude(longitude);\n\n              point = {\n                \"type\": \"Point\",\n                properties: {\n                  name: \"EPSG:4326\"\n                },\n                \"coordinates\": [longitude, latitude]\n              };\n              updateCity({\n                variables: {\n                  userId: userId,\n                  city: _city\n                }\n              });\n              updateRegion({\n                variables: {\n                  userId: userId,\n                  region: _region\n                }\n              });\n\n            case 26:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    })();\n  };\n\n  function LocationHeader() {\n    if (locationServices) {\n      return React.createElement(Text, {\n        style: {\n          color: colors.primaryWhite,\n          fontSize: 20,\n          fontWeight: '600',\n          paddingBottom: 20\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 17\n        }\n      }, city, \", \", region);\n    } else {\n      return React.createElement(Text, {\n        style: {\n          color: colors.primaryWhite,\n          fontSize: 20,\n          fontWeight: '600',\n          paddingBottom: 20\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 17\n        }\n      }, \"No location found\");\n    }\n  }\n\n  return React.createElement(View, {\n    style: {\n      backgroundColor: colors.primaryBlack,\n      flex: 1,\n      paddingTop: '15%',\n      alignItems: 'center'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 9\n    }\n  }, React.createElement(LocationHeader, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 13\n    }\n  }), React.createElement(TouchableOpacity, {\n    onPress: enableLocation,\n    style: {\n      padding: 10,\n      borderWidth: 1,\n      borderColor: colors.primaryWhite,\n      borderRadius: 3\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 13\n    }\n  }, React.createElement(Text, {\n    style: {\n      color: colors.primaryWhite,\n      fontSize: 18,\n      fontWeight: '200'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 21\n    }\n  }, buttonText)));\n}","map":{"version":3,"sources":["/Users/vaibhavverma9/Desktop/realtalk-app/dating-app/app/components/videosPage/EditLocationView.tsx"],"names":["React","useEffect","useState","useContext","colors","Location","_storeLatitude","_storeLongitude","_storeCity","_storeRegion","UPDATE_CITY","UPDATE_REGION","useMutation","UserIdContext","EditLocationView","props","locationServices","setLocationServices","route","params","city","setCity","region","setRegion","updateCity","updateCityData","updateRegion","updateRegionData","userId","setUserId","buttonText","setButtonText","checkLocation","getPermissionsAsync","status","enableLocation","requestPermissionsAsync","getCurrentPositionAsync","location","latitude","coords","longitude","reverseGeocodeAsync","postalAddress","point","properties","name","variables","LocationHeader","color","primaryWhite","fontSize","fontWeight","paddingBottom","backgroundColor","primaryBlack","flex","paddingTop","alignItems","padding","borderWidth","borderColor","borderRadius"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useContext }  from 'react';\nimport { View, Text, TouchableOpacity} from 'react-native';\nimport { colors } from '../../styles/colors';\nimport * as Location from 'expo-location';\nimport { _storeLatitude, _storeLongitude, _storeCity, _storeRegion } from '../../utils/asyncStorage'; \nimport { UPDATE_LATITUDE_LONGITUDE, UPDATE_CITY, UPDATE_REGION } from '../../utils/graphql/GraphqlClient';\nimport { useMutation } from '@apollo/client';\nimport { UserIdContext } from '../../utils/context/UserIdContext'\n\nexport default function EditLocationView(props) {\n\n    const [locationServices, setLocationServices] = useState(false); \n    const [city, setCity] = useState(props.route.params.city); \n    const [region, setRegion] = useState(props.route.params.region); \n    // const [updateLatitudeLongitude, { updateLatitudeLongitudeData }] = useMutation(UPDATE_LATITUDE_LONGITUDE);\n    const [updateCity, { updateCityData }] = useMutation(UPDATE_CITY);\n    const [updateRegion, { updateRegionData }] = useMutation(UPDATE_REGION);\n    const [userId, setUserId] = useContext(UserIdContext);\n    const [buttonText, setButtonText] = useState('Set your location'); \n\n    useEffect(() => {\n        checkLocation();\n    }, []);\n\n    async function checkLocation(){\n        (async () => { \n            let { status } = await Location.getPermissionsAsync(); \n            if (status !== 'granted'){\n                setLocationServices(false); \n                setButtonText('Set your location');\n            } else {\n                setLocationServices(true); \n                setButtonText('Update current location');\n            }\n        }); \n        if(city && region && city != '' && region != ''){\n            setLocationServices(true); \n            setButtonText('Update current location');\n        }\n    }\n\n    const enableLocation = () => {\n        (async () => {\n            let { status } = await Location.requestPermissionsAsync();\n            if (status == 'granted') {\n                setLocationServices(true); \n                setButtonText('Updated to current location'); \n\n                let location = await Location.getCurrentPositionAsync({});\n                const latitude = location.coords.latitude; \n                const longitude = location.coords.longitude; \n\n                let postalAddress = await Location.reverseGeocodeAsync({ latitude, longitude });\n\n                const city = postalAddress[0].city; \n                const region = postalAddress[0].region;  \n   \n                setCity(city);\n                setRegion(region); \n\n                _storeCity(city);\n                _storeRegion(region); \n\n                _storeLatitude(latitude); \n                _storeLongitude(longitude);\n\n                const point = {\n                    \"type\" : \"Point\", \n                    properties: {\n                        name: \"EPSG:4326\"\n                      },\n                    \"coordinates\": [longitude, latitude]\n                }; \n\n\n                // updateLatitudeLongitude({ variables: { userId, point }});\n                updateCity({ variables: { userId, city }}); \n                updateRegion({ variables: { userId, region }}); \n            }\n        })();\n    }\n\n    function LocationHeader(){\n        if(locationServices){\n            return (\n                <Text style={{ color: colors.primaryWhite, fontSize: 20, fontWeight: '600', paddingBottom: 20 }}>{city}, {region}</Text>\n            )\n        } else {\n            return (\n                <Text style={{ color: colors.primaryWhite, fontSize: 20, fontWeight: '600', paddingBottom: 20 }}>No location found</Text>\n            )\n        }\n    }\n\n    return (\n        <View style={{ backgroundColor: colors.primaryBlack, flex: 1, paddingTop: '15%', alignItems: 'center'}}>\n            <LocationHeader />\n            <TouchableOpacity onPress={enableLocation} style={{ padding: 10, borderWidth: 1, borderColor: colors.primaryWhite, borderRadius: 3 }}>\n                    <Text style={{ color: colors.primaryWhite, fontSize: 18, fontWeight: '200' }}>{buttonText}</Text>\n            </TouchableOpacity>\n        </View>\n    )\n}"]},"metadata":{},"sourceType":"module"}