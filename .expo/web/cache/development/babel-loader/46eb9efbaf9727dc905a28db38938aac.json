{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/Users/vaibhavverma9/Desktop/realtalk-app/dating-app/app/components/messagesPage/MessagesStreamView.tsx\";\nimport React, { useEffect, useState, useContext, createRef } from 'react';\nimport { StreamChat } from 'stream-chat';\nimport View from \"react-native-web/dist/exports/View\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport ImageBackground from \"react-native-web/dist/exports/ImageBackground\";\nimport { UserIdContext } from \"../../utils/context/UserIdContext\";\nimport { _retrieveName } from \"../../utils/asyncStorage\";\nimport { Chat, Channel, MessageList, MessageInput, ChannelList } from \"stream-chat-expo\";\nimport { createAppContainer } from 'react-navigation';\nimport { createStackNavigator } from 'react-navigation-stack';\nimport axios from 'axios';\nimport { GET_MATCHES_LIKES, INSERT_LIKE } from \"../../utils/graphql/GraphqlClient\";\nimport { useLazyQuery, useMutation } from '@apollo/client';\nimport * as Segment from 'expo-analytics-segment';\nimport { colors } from \"../../styles/colors\";\nimport FullPageVideos from \"../modals/FullPageVideos\";\nimport { Ionicons, Feather } from '@expo/vector-icons';\nimport MessagesOptions from \"./MessagesOptions\";\nvar chatClient = new StreamChat('9uzx7652xgte');\nexport default function MessagesStreamView(props) {\n  var _useContext = useContext(UserIdContext),\n      _useContext2 = _slicedToArray(_useContext, 2),\n      userId = _useContext2[0],\n      setUserId = _useContext2[1];\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      loading = _useState2[0],\n      setLoading = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      allData = _useState4[0],\n      setAllData = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      likesData = _useState6[0],\n      setLikesData = _useState6[1];\n\n  var _useState7 = useState([]),\n      _useState8 = _slicedToArray(_useState7, 2),\n      matchesData = _useState8[0],\n      setMatchesData = _useState8[1];\n\n  var _useState9 = useState([]),\n      _useState10 = _slicedToArray(_useState9, 2),\n      enabledData = _useState10[0],\n      setEnabledData = _useState10[1];\n\n  var _useState11 = useState(false),\n      _useState12 = _slicedToArray(_useState11, 2),\n      timedOut = _useState12[0],\n      setTimedOut = _useState12[1];\n\n  var initDisabled = {\n    all: true,\n    matches: false,\n    likes: false\n  };\n\n  var _useState13 = useState(initDisabled),\n      _useState14 = _slicedToArray(_useState13, 2),\n      disabled = _useState14[0],\n      setDisabled = _useState14[1];\n\n  var _useState15 = useState(false),\n      _useState16 = _slicedToArray(_useState15, 2),\n      messagesOptionsVisible = _useState16[0],\n      setMessagesOptionsVisible = _useState16[1];\n\n  var _useState17 = useState(null),\n      _useState18 = _slicedToArray(_useState17, 2),\n      optionsProfileId = _useState18[0],\n      setOptionsProfileId = _useState18[1];\n\n  var _useMutation = useMutation(INSERT_LIKE),\n      _useMutation2 = _slicedToArray(_useMutation, 2),\n      insertLike = _useMutation2[0],\n      insertLikeData = _useMutation2[1].insertLikeData;\n\n  var _useLazyQuery = useLazyQuery(GET_MATCHES_LIKES, {\n    onCompleted: function onCompleted(likesQueried) {\n      var matches = likesQueried.matches;\n      var likes = likesQueried.likes;\n      setAllData([].concat(_toConsumableArray(matches), _toConsumableArray(likes)));\n      setMatchesData(matches);\n      setLikesData(likes);\n    }\n  }),\n      _useLazyQuery2 = _slicedToArray(_useLazyQuery, 2),\n      getLikes = _useLazyQuery2[0],\n      likesQueried = _useLazyQuery2[1].data;\n\n  useEffect(function () {\n    Segment.screen('Messages');\n    getLikes({\n      variables: {\n        userId: userId\n      }\n    });\n    setTimeout(function () {\n      setTimedOut(true);\n    }, 3000);\n  }, []);\n  useEffect(function () {\n    if (allData.length > 0) {\n      if (disabled.all) {\n        setEnabledData(allData);\n      } else if (disabled.matches) {\n        setEnabledData(matchesData);\n      } else if (disabled.likes) {\n        setEnabledData(likesData);\n      }\n    }\n  }, [disabled, allData]);\n  useEffect(function () {\n    if (allData.length > 0) {\n      initClient();\n    }\n  }, [allData]);\n\n  function initClient() {\n    var token, response, name, profileIds, _response, filter, sort, channels, i, like, profileId, _filter, _sort, _channels, _response2;\n\n    return _regeneratorRuntime.async(function initClient$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            setLoading(true);\n            _context.prev = 1;\n            _context.next = 4;\n            return _regeneratorRuntime.awrap(axios.post(\"https://gentle-brook-91508.herokuapp.com/joinStream\", {\n              userId: userId.toString()\n            }));\n\n          case 4:\n            response = _context.sent;\n            token = response.data.token;\n            _context.next = 12;\n            break;\n\n          case 8:\n            _context.prev = 8;\n            _context.t0 = _context[\"catch\"](1);\n            console.log(_context.t0);\n            return _context.abrupt(\"return\");\n\n          case 12:\n            _context.next = 14;\n            return _regeneratorRuntime.awrap(_retrieveName());\n\n          case 14:\n            name = _context.sent;\n            _context.next = 17;\n            return _regeneratorRuntime.awrap(chatClient.disconnect());\n\n          case 17:\n            _context.next = 19;\n            return _regeneratorRuntime.awrap(chatClient.setUser({\n              id: userId.toString(),\n              name: name\n            }, token));\n\n          case 19:\n            setLoading(false);\n            profileIds = allData.map(function (like) {\n              if (like.profileUser.userVideos.length > 0) {\n                return {\n                  id: like.profileId.toString(),\n                  name: like.profileUser.firstName,\n                  image: 'https://image.mux.com/' + like.profileUser.userVideos[0].muxPlaybackId + '/thumbnail.jpg?time=0'\n                };\n              } else {\n                return {\n                  id: like.profileId.toString(),\n                  name: like.profileUser.firstName\n                };\n              }\n            });\n            _context.prev = 21;\n            _context.next = 24;\n            return _regeneratorRuntime.awrap(axios.post(\"https://gentle-brook-91508.herokuapp.com/updateUsersStream\", {\n              likerIds: profileIds\n            }));\n\n          case 24:\n            _response = _context.sent;\n            _context.next = 31;\n            break;\n\n          case 27:\n            _context.prev = 27;\n            _context.t1 = _context[\"catch\"](21);\n            console.log(_context.t1);\n            return _context.abrupt(\"return\");\n\n          case 31:\n            filter = {\n              type: 'messaging',\n              $and: [{\n                members: {\n                  $in: [userId.toString()]\n                }\n              }]\n            };\n            sort = {\n              last_message_at: -1\n            };\n            _context.next = 35;\n            return _regeneratorRuntime.awrap(chatClient.queryChannels(filter, sort, {\n              watch: true,\n              state: true\n            }));\n\n          case 35:\n            channels = _context.sent;\n            i = 0;\n\n          case 37:\n            if (!(i < allData.length)) {\n              _context.next = 58;\n              break;\n            }\n\n            like = allData[i];\n            profileId = like.profileId;\n            _filter = {\n              type: 'messaging',\n              $and: [{\n                members: {\n                  $in: [userId.toString()]\n                }\n              }, {\n                members: {\n                  $in: [profileId.toString()]\n                }\n              }]\n            };\n            _sort = {\n              last_message_at: -1\n            };\n            _context.next = 44;\n            return _regeneratorRuntime.awrap(chatClient.queryChannels(_filter, _sort, {\n              watch: true,\n              state: true\n            }));\n\n          case 44:\n            _channels = _context.sent;\n\n            if (!(_channels.length == 0)) {\n              _context.next = 55;\n              break;\n            }\n\n            _context.prev = 46;\n            _context.next = 49;\n            return _regeneratorRuntime.awrap(axios.post(\"https://gentle-brook-91508.herokuapp.com/createChannelStream\", {\n              userId: userId.toString(),\n              likerId: profileId.toString()\n            }));\n\n          case 49:\n            _response2 = _context.sent;\n            _context.next = 55;\n            break;\n\n          case 52:\n            _context.prev = 52;\n            _context.t2 = _context[\"catch\"](46);\n            return _context.abrupt(\"return\");\n\n          case 55:\n            i++;\n            _context.next = 37;\n            break;\n\n          case 58:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[1, 8], [21, 27], [46, 52]], Promise);\n  }\n\n  ;\n\n  function CustomChannelPreview(props) {\n    var channelPreviewButton = createRef();\n\n    var onSelectChannel = function onSelectChannel() {\n      props.setActiveChannel(props.channel);\n    };\n\n    var channel = props.channel;\n    var unreadCount = channel.countUnread();\n    var profileId = parseInt(props.channel.data.membersIds.filter(function (memberId) {\n      return memberId != userId.toString();\n    })[0]);\n    var like = enabledData.filter(function (like) {\n      return profileId == like.profileId;\n    });\n\n    if (like.length == 0) {\n      return null;\n    }\n\n    var firstName = like[0].profileUser.firstName;\n    var videos = like[0].profileUser.userVideos;\n    var latestMessage = props.latestMessage.text;\n\n    function VideosDisplay(_ref) {\n      var videos = _ref.videos;\n\n      if (videos && videos.length > 0) {\n        return React.createElement(View, {\n          style: styles.videoSectionStyle,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 200,\n            columnNumber: 11\n          }\n        }, videos.map(function (video) {\n          return React.createElement(VideoView, {\n            key: video.id,\n            video: video,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 201,\n              columnNumber: 34\n            }\n          });\n        }));\n      } else {\n        return null;\n      }\n    }\n\n    function VideoView(_ref2) {\n      var video = _ref2.video;\n      var muxPlaybackId = video.muxPlaybackId;\n      var muxThumbnailUrl = 'https://image.mux.com/' + muxPlaybackId + '/thumbnail.jpg?time=0';\n\n      var _useState19 = useState(false),\n          _useState20 = _slicedToArray(_useState19, 2),\n          fullVideoVisible = _useState20[0],\n          setFullVideoVisible = _useState20[1];\n\n      var goToVideo = function goToVideo() {\n        setFullVideoVisible(true);\n      };\n\n      return React.createElement(View, {\n        style: styles.thumbnailPaddingStyle,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 9\n        }\n      }, React.createElement(TouchableOpacity, {\n        onPress: goToVideo,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 221,\n          columnNumber: 11\n        }\n      }, React.createElement(ImageBackground, {\n        style: styles.thumbnailDimensions,\n        source: {\n          uri: muxThumbnailUrl\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 15\n        }\n      })), React.createElement(FullPageVideos, {\n        visible: fullVideoVisible,\n        setVisible: setFullVideoVisible,\n        source: 'https://stream.mux.com/' + muxPlaybackId + '.m3u8',\n        questionText: video.videoQuestion.questionText,\n        videoId: video.id,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 11\n        }\n      }));\n    }\n\n    return React.createElement(TouchableOpacity, {\n      style: {\n        display: 'flex',\n        borderBottomColor: colors.primaryPurple,\n        borderBottomWidth: 1,\n        paddingVertical: 10\n      },\n      onPress: onSelectChannel,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 7\n      }\n    }, React.createElement(View, {\n      style: {\n        flexDirection: 'row',\n        justifyContent: 'space-between',\n        alignItems: 'center'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 9\n      }\n    }, React.createElement(View, {\n      style: {\n        justifyContent: 'space-around',\n        height: 40\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 11\n      }\n    }, React.createElement(Text, {\n      style: {\n        fontWeight: 'bold',\n        fontSize: 14,\n        flex: 9\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 13\n      }\n    }, firstName), React.createElement(Text, {\n      style: {\n        fontWeight: unreadCount > 0 ? 'bold' : 'normal',\n        fontSize: 14,\n        flex: 9\n      },\n      ellipsizeMode: \"tail\",\n      numberOfLines: 1,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 13\n      }\n    }, latestMessage))), React.createElement(VideosDisplay, {\n      videos: videos,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 9\n      }\n    }));\n  }\n\n  function goToAddVideo() {\n    props.navigation.navigate('Add');\n  }\n\n  function AddVideo() {\n    return React.createElement(View, {\n      style: {\n        height: '100%',\n        justifyContent: 'center',\n        alignItems: 'center'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 9\n      }\n    }, React.createElement(View, {\n      style: {\n        height: '40%',\n        width: '85%',\n        backgroundColor: colors.primaryPurple,\n        borderRadius: 5,\n        padding: 10,\n        alignItems: 'center'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 11\n      }\n    }, React.createElement(View, {\n      style: {\n        paddingTop: '5%',\n        height: '25%'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 289,\n        columnNumber: 15\n      }\n    }, React.createElement(Feather, {\n      name: \"video\",\n      size: 45,\n      color: colors.primaryWhite,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 290,\n        columnNumber: 19\n      }\n    })), React.createElement(Text, {\n      style: {\n        fontSize: 22,\n        fontWeight: 'bold',\n        paddingTop: 12,\n        paddingBottom: 5,\n        color: colors.primaryWhite\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 15\n      }\n    }, \"No likes yet!\"), React.createElement(Text, {\n      style: {\n        textAlign: 'center',\n        fontSize: 20,\n        fontWeight: '300',\n        paddingHorizontal: 5,\n        color: colors.primaryWhite\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293,\n        columnNumber: 15\n      }\n    }, \"Add videos to get likes from users :)\"), React.createElement(TouchableOpacity, {\n      onPress: goToAddVideo,\n      style: {\n        paddingTop: '8%'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 15\n      }\n    }, React.createElement(View, {\n      style: styles.addVideoContainer,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 295,\n        columnNumber: 19\n      }\n    }, React.createElement(Text, {\n      style: styles.addVideoText,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 296,\n        columnNumber: 23\n      }\n    }, \"Add Video\")))));\n  }\n\n  function ChannelListScreen(props) {\n    if (allData) {\n      if (allData.length > 0) {\n        return React.createElement(SafeAreaView, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 308,\n            columnNumber: 11\n          }\n        }, React.createElement(Chat, {\n          client: chatClient,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 309,\n            columnNumber: 13\n          }\n        }, React.createElement(View, {\n          style: {\n            display: 'flex',\n            height: '100%',\n            padding: 10\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 310,\n            columnNumber: 15\n          }\n        }, React.createElement(ChannelList, {\n          filters: {\n            type: 'messaging',\n            members: {\n              $in: [userId.toString()]\n            }\n          },\n          sort: {\n            last_message_at: -1\n          },\n          Preview: CustomChannelPreview,\n          onSelect: function onSelect(channel) {\n            props.navigation.navigate('Channel', {\n              channel: channel\n            });\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 311,\n            columnNumber: 17\n          }\n        }), React.createElement(MessagesOptions, {\n          visible: messagesOptionsVisible,\n          setVisible: setMessagesOptionsVisible,\n          userId: userId,\n          currentUserId: optionsProfileId,\n          allData: allData,\n          setAllData: setAllData,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 321,\n            columnNumber: 17\n          }\n        }))));\n      } else {\n        return React.createElement(AddVideo, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 335,\n            columnNumber: 11\n          }\n        });\n      }\n    } else {\n      return null;\n    }\n  }\n\n  function disableHeader(_ref3) {\n    var text = _ref3.text;\n\n    if (text == 'ALL') {\n      setDisabled({\n        all: true,\n        matches: false,\n        likes: false\n      });\n    } else if (text == 'MATCHES') {\n      setDisabled({\n        all: false,\n        matches: true,\n        likes: false\n      });\n    } else if (text == 'LIKES') {\n      setDisabled({\n        all: false,\n        matches: false,\n        likes: true\n      });\n    }\n  }\n\n  function HeaderButton(_ref4) {\n    var text = _ref4.text,\n        disabled = _ref4.disabled;\n    var textStyle = disabled ? styles.headerText : styles.disabledHeaderText;\n    return React.createElement(TouchableOpacity, {\n      onPress: function onPress() {\n        disableHeader({\n          text: text\n        });\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 357,\n        columnNumber: 7\n      }\n    }, React.createElement(View, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 358,\n        columnNumber: 9\n      }\n    }, React.createElement(Text, {\n      style: textStyle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 359,\n        columnNumber: 11\n      }\n    }, text)));\n  }\n\n  ChannelListScreen.navigationOptions = function () {\n    return {\n      headerTitle: function headerTitle() {\n        return React.createElement(View, {\n          style: {\n            paddingBottom: '1%',\n            flexDirection: 'row',\n            justifyContent: 'space-around',\n            width: '100%'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 366,\n            columnNumber: 7\n          }\n        }, React.createElement(HeaderButton, {\n          text: 'ALL',\n          disabled: disabled.all,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 367,\n            columnNumber: 11\n          }\n        }), React.createElement(HeaderButton, {\n          text: 'MATCHES',\n          disabled: disabled.matches,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 368,\n            columnNumber: 11\n          }\n        }), React.createElement(HeaderButton, {\n          text: 'LIKES',\n          disabled: disabled.likes,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 369,\n            columnNumber: 11\n          }\n        }));\n      }\n    };\n  };\n\n  function ChannelScreen(props) {\n    var channel = props.navigation.getParam('channel');\n    return React.createElement(SafeAreaView, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 378,\n        columnNumber: 7\n      }\n    }, React.createElement(Chat, {\n      client: chatClient,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 379,\n        columnNumber: 9\n      }\n    }, React.createElement(Channel, {\n      client: chatClient,\n      channel: channel,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 380,\n        columnNumber: 11\n      }\n    }, React.createElement(View, {\n      style: {\n        display: 'flex',\n        height: '100%'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 381,\n        columnNumber: 13\n      }\n    }, React.createElement(MessageList, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 382,\n        columnNumber: 15\n      }\n    }), React.createElement(MessageInput, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 383,\n        columnNumber: 15\n      }\n    })))));\n  }\n\n  ChannelScreen.navigationOptions = function (_ref5) {\n    var navigation = _ref5.navigation;\n    var channel = navigation.getParam('channel');\n    var profileId = parseInt(channel.data.membersIds.filter(function (memberId) {\n      return memberId != userId.toString();\n    })[0]);\n    var like = enabledData.filter(function (like) {\n      return profileId == like.profileId;\n    });\n    var currentName = like[0].profileUser.firstName;\n\n    var moreOptions = function moreOptions() {\n      setMessagesOptionsVisible(true);\n      setOptionsProfileId(profileId);\n    };\n\n    return {\n      title: currentName,\n      headerBackTitleVisible: false,\n      headerRight: function headerRight() {\n        return React.createElement(TouchableOpacity, {\n          onPress: moreOptions,\n          style: {\n            paddingRight: 20\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 413,\n            columnNumber: 9\n          }\n        }, React.createElement(Ionicons, {\n          name: \"ios-more\",\n          size: 30,\n          color: colors.primaryBlack,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 414,\n            columnNumber: 11\n          }\n        }));\n      }\n    };\n  };\n\n  var RootStack = createStackNavigator({\n    ChannelList: {\n      screen: ChannelListScreen\n    },\n    Channel: {\n      screen: ChannelScreen\n    }\n  }, {\n    initialRouteName: 'ChannelList'\n  });\n  var AppContainer = createAppContainer(RootStack);\n  return React.createElement(AppContainer, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 437,\n      columnNumber: 7\n    }\n  });\n}\nvar windowWidth = Math.round(Dimensions.get('window').width);\nvar thumbnailWidth = windowWidth * 0.32;\nvar thumbnailHeight = windowWidth * 0.4;\nvar styles = StyleSheet.create({\n  videoSectionStyle: {\n    flex: 1,\n    flexDirection: 'row'\n  },\n  thumbnailPaddingStyle: {\n    padding: '0.2%'\n  },\n  thumbnailDimensions: {\n    width: thumbnailWidth,\n    height: thumbnailHeight\n  },\n  headerText: {\n    margin: 8,\n    textAlign: 'center',\n    fontSize: 15,\n    fontWeight: 'bold',\n    color: colors.primaryPurple\n  },\n  disabledHeaderText: {\n    margin: 8,\n    textAlign: 'center',\n    fontSize: 15,\n    color: colors.secondaryGray\n  },\n  addVideoContainer: {\n    backgroundColor: colors.primaryWhite,\n    borderRadius: 5,\n    width: 250,\n    height: 50,\n    justifyContent: 'center',\n    alignItems: 'center'\n  },\n  addVideoText: {\n    fontSize: 17,\n    color: colors.primaryPurple,\n    fontWeight: 'bold'\n  }\n});","map":{"version":3,"sources":["/Users/vaibhavverma9/Desktop/realtalk-app/dating-app/app/components/messagesPage/MessagesStreamView.tsx"],"names":["React","useEffect","useState","useContext","createRef","StreamChat","UserIdContext","_retrieveName","Chat","Channel","MessageList","MessageInput","ChannelList","createAppContainer","createStackNavigator","axios","GET_MATCHES_LIKES","INSERT_LIKE","useLazyQuery","useMutation","Segment","colors","FullPageVideos","Ionicons","Feather","MessagesOptions","chatClient","MessagesStreamView","props","userId","setUserId","loading","setLoading","allData","setAllData","likesData","setLikesData","matchesData","setMatchesData","enabledData","setEnabledData","timedOut","setTimedOut","initDisabled","all","matches","likes","disabled","setDisabled","messagesOptionsVisible","setMessagesOptionsVisible","optionsProfileId","setOptionsProfileId","insertLike","insertLikeData","onCompleted","likesQueried","getLikes","data","screen","variables","setTimeout","length","initClient","post","toString","response","token","console","log","name","disconnect","setUser","id","profileIds","map","like","profileUser","userVideos","profileId","firstName","image","muxPlaybackId","likerIds","filter","type","$and","members","$in","sort","last_message_at","queryChannels","watch","state","channels","i","likerId","CustomChannelPreview","channelPreviewButton","onSelectChannel","setActiveChannel","channel","unreadCount","countUnread","parseInt","membersIds","memberId","videos","latestMessage","text","VideosDisplay","styles","videoSectionStyle","video","VideoView","muxThumbnailUrl","fullVideoVisible","setFullVideoVisible","goToVideo","thumbnailPaddingStyle","thumbnailDimensions","uri","videoQuestion","questionText","display","borderBottomColor","primaryPurple","borderBottomWidth","paddingVertical","flexDirection","justifyContent","alignItems","height","fontWeight","fontSize","flex","goToAddVideo","navigation","navigate","AddVideo","width","backgroundColor","borderRadius","padding","paddingTop","primaryWhite","paddingBottom","color","textAlign","paddingHorizontal","addVideoContainer","addVideoText","ChannelListScreen","disableHeader","HeaderButton","textStyle","headerText","disabledHeaderText","navigationOptions","headerTitle","ChannelScreen","getParam","currentName","moreOptions","title","headerBackTitleVisible","headerRight","paddingRight","primaryBlack","RootStack","initialRouteName","AppContainer","windowWidth","Math","round","Dimensions","get","thumbnailWidth","thumbnailHeight","StyleSheet","create","margin","secondaryGray"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useContext, createRef } from 'react';\nimport { StreamChat } from 'stream-chat';\nimport { View, SafeAreaView, TouchableOpacity, Text, StyleSheet, Dimensions, ImageBackground } from \"react-native\";\nimport { UserIdContext } from '../../utils/context/UserIdContext';\nimport { _retrieveStreamToken, _storeStreamToken, _retrieveName } from '../../utils/asyncStorage'; \nimport {\n  Avatar,\n  Chat,\n  Channel,\n  MessageList,\n  MessageInput,\n  ChannelList,\n  IconBadge,\n} from \"stream-chat-expo\";\n\nimport { createAppContainer } from 'react-navigation';\nimport { createStackNavigator } from 'react-navigation-stack';\nimport axios from 'axios';\nimport { GET_MATCHES_LIKES, INSERT_LIKE } from '../../utils/graphql/GraphqlClient';\nimport { useLazyQuery, useMutation } from '@apollo/client';\nimport * as Segment from 'expo-analytics-segment';\nimport { colors } from '../../styles/colors';\nimport FullPageVideos from '../modals/FullPageVideos';\nimport { Ionicons, Feather, Entypo } from '@expo/vector-icons'\nimport MessagesOptions from './MessagesOptions'; \n\nconst chatClient = new StreamChat('9uzx7652xgte');\n\nexport default function MessagesStreamView(props) {\n\n  const [userId, setUserId] = useContext(UserIdContext);\n  const [loading, setLoading] = useState(false);\n  const [allData, setAllData] = useState([]); \n  const [likesData, setLikesData] = useState([]); \n  const [matchesData, setMatchesData] = useState([]);\n  const [enabledData, setEnabledData] = useState([])\n  const [timedOut, setTimedOut] = useState(false);\n\n  const initDisabled = { all: true, matches: false, likes: false };\n  const [disabled, setDisabled] = useState(initDisabled);\n\n  const [messagesOptionsVisible, setMessagesOptionsVisible] = useState(false); \n  const [optionsProfileId, setOptionsProfileId] = useState(null); \n  const [insertLike, { insertLikeData }] = useMutation(INSERT_LIKE);\n\n  const [getLikes, { data: likesQueried }] = useLazyQuery(GET_MATCHES_LIKES, \n  { \n    onCompleted: (likesQueried) => { \n      const matches = likesQueried.matches;\n      const likes = likesQueried.likes;\n      setAllData([...matches, ...likes]); \n      setMatchesData(matches);\n      setLikesData(likes);\n    } \n  }); \n\n  useEffect(() => {\n    Segment.screen('Messages'); \n    getLikes({ variables: { userId }}); \n    setTimeout(() => { setTimedOut(true) }, 3000); \n  }, []);\n\n  useEffect(() => {\n    if(allData.length > 0){\n      if(disabled.all){\n        setEnabledData(allData); \n      } else if(disabled.matches){\n        setEnabledData(matchesData); \n      } else if(disabled.likes){\n        setEnabledData(likesData); \n      }\n    }\n  }, [disabled, allData]);\n\n  useEffect(() => {\n    if(allData.length > 0){\n      initClient(); \n    }   \n  }, [allData]);\n\n  async function initClient() {\n    setLoading(true);\n    let token;\n    try {\n      const response = await axios.post(\"https://gentle-brook-91508.herokuapp.com/joinStream\", {\n        userId: userId.toString()\n      });\n      token = response.data.token;\n    } catch (err) {\n      console.log(err); \n      return;\n    }\n\n    let name = await _retrieveName(); \n\n\n    await chatClient.disconnect();\n\n    await chatClient.setUser( \n      {\n        id: userId.toString(),\n        name: name\n      },\n      token\n    );\n\n    setLoading(false);\n\n    const profileIds = allData.map(like => {\n      if(like.profileUser.userVideos.length > 0){\n        return { \n          id: like.profileId.toString(),\n          name: like.profileUser.firstName,\n          image: 'https://image.mux.com/' + like.profileUser.userVideos[0].muxPlaybackId + '/thumbnail.jpg?time=0'\n        };   \n      } else {\n        return { \n          id: like.profileId.toString(),\n          name: like.profileUser.firstName\n        };   \n      }\n    });\n\n    try {\n      const response = await axios.post(\"https://gentle-brook-91508.herokuapp.com/updateUsersStream\", {\n        likerIds: profileIds\n      });\n    } catch (err) {\n      console.log(err); \n      return;\n    }\n\n    const filter = { type: 'messaging', $and : [{ members: { $in: [userId.toString()]}}]};\n    const sort = { last_message_at: -1 };\n\n\n    const channels = await chatClient.queryChannels(filter, sort, {\n      watch: true,\n      state: true,\n    });  \n\n    for(let i=0; i < allData.length; i++){\n      const like = allData[i]; \n      const profileId = like.profileId; \n\n      const filter = { type: 'messaging', $and : [{ members: { $in: [userId.toString()]}}, { members: { $in: [profileId.toString()]}}]};\n      const sort = { last_message_at: -1 };\n  \n  \n      const channels = await chatClient.queryChannels(filter, sort, {\n        watch: true,\n        state: true,\n      });  \n\n      if(channels.length == 0){\n        try {\n          const response = await axios.post(\"https://gentle-brook-91508.herokuapp.com/createChannelStream\", {\n            userId: userId.toString(),\n            likerId: profileId.toString(),\n          });\n        } catch (err) {\n          return;\n        }\n      }\n    }\n  };\n\n  function CustomChannelPreview(props){\n    const channelPreviewButton = createRef(); \n\n    const onSelectChannel = () => {\n      props.setActiveChannel(props.channel); \n    }\n\n    const channel = props.channel; \n    const unreadCount = channel.countUnread();\n\n    const profileId = parseInt(props.channel.data.membersIds.filter(memberId => {\n      return memberId != userId.toString(); \n    })[0]);    \n\n    const like = enabledData.filter(like => {\n      return profileId == like.profileId; \n    });\n\n    if(like.length == 0){\n      return null;\n    }\n\n    const firstName = like[0].profileUser.firstName;\n    const videos = like[0].profileUser.userVideos;\n    // console.log(like[0].profileUser.id); \n    const latestMessage = props.latestMessage.text;\n\n    function VideosDisplay({videos}){\n\n      if(videos && videos.length > 0){\n  \n        return (\n          <View style={styles.videoSectionStyle}>\n            {videos.map(video => <VideoView key={video.id} video={video} />)}\n          </View>\n        ) \n      } else {\n          return null; \n      }\n    }\n  \n    function VideoView({ video }){\n  \n      const muxPlaybackId = video.muxPlaybackId; \n      const muxThumbnailUrl = 'https://image.mux.com/' + muxPlaybackId + '/thumbnail.jpg?time=0';\n      const [fullVideoVisible, setFullVideoVisible] = useState(false);\n  \n      const goToVideo = () => {\n        setFullVideoVisible(true); \n      }\n  \n      return (\n        <View style={styles.thumbnailPaddingStyle}>\n          <TouchableOpacity onPress={goToVideo}>\n              <ImageBackground \n                  style={styles.thumbnailDimensions}\n                  source={{uri: muxThumbnailUrl }}\n              >\n              </ImageBackground>\n          </TouchableOpacity>\n          <FullPageVideos \n            visible={fullVideoVisible} \n            setVisible={setFullVideoVisible} \n            source={'https://stream.mux.com/' + muxPlaybackId + '.m3u8'}\n            questionText={video.videoQuestion.questionText}\n            videoId={video.id}\n          />\n        </View>\n      )\n    }\n\n    return (\n      <TouchableOpacity\n        style={{\n          display: 'flex',\n          borderBottomColor: colors.primaryPurple,\n          borderBottomWidth: 1,\n          paddingVertical: 10\n        }}\n        onPress={onSelectChannel}\n      >\n        <View style={{ flexDirection: 'row', justifyContent: 'space-between', alignItems: 'center'}}>\n          <View style={{ justifyContent: 'space-around', height: 40}}>\n            <Text\n              style={{\n                fontWeight: 'bold',\n                fontSize: 14,\n                flex: 9\n              }}\n            >\n              {firstName}\n            </Text>\n            <Text\n              style={{\n                fontWeight: unreadCount > 0 ? 'bold' : 'normal',\n                fontSize: 14,\n                flex: 9,\n              }}\n              ellipsizeMode=\"tail\"\n              numberOfLines={1}\n            >\n              {latestMessage}\n            </Text>\n          </View>\n        </View>\n        <VideosDisplay videos={videos} />\n\n      </TouchableOpacity>\n    );\n\n  }\n\n  function goToAddVideo(){\n    props.navigation.navigate('Add');\n  }\n\n\n  function AddVideo(){\n      return (\n        <View style={{ height: '100%', justifyContent: 'center', alignItems: 'center' }}>\n          <View style={{ height: '40%', width: '85%', backgroundColor: colors.primaryPurple, borderRadius: 5, padding: 10, alignItems: 'center' }}>\n              <View style={{ paddingTop: '5%', height: '25%'}}>\n                  <Feather name=\"video\" size={45} color={colors.primaryWhite} />\n              </View>        \n              <Text style={{ fontSize: 22, fontWeight: 'bold', paddingTop: 12, paddingBottom: 5, color: colors.primaryWhite }}>No likes yet!</Text>\n              <Text style={{ textAlign: 'center', fontSize: 20, fontWeight: '300', paddingHorizontal: 5, color: colors.primaryWhite }}>Add videos to get likes from users :)</Text>\n              <TouchableOpacity onPress={goToAddVideo} style={{ paddingTop: '8%' }}>\n                  <View style={styles.addVideoContainer}>\n                      <Text style={styles.addVideoText}>Add Video</Text>\n                  </View>\n              </TouchableOpacity>\n          </View>\n\n      </View>           )\n  }\n\n  function ChannelListScreen(props){\n    if(allData){\n      if(allData.length > 0){\n        return (\n          <SafeAreaView>\n            <Chat client={chatClient}>\n              <View style={{ display: 'flex', height: '100%', padding: 10 }}>\n                <ChannelList\n                  filters={{ type: 'messaging', members: { $in: [userId.toString()] } }}\n                  sort={{ last_message_at: -1 }}\n                  Preview={CustomChannelPreview}\n                  onSelect={(channel) => {\n                    props.navigation.navigate('Channel', {\n                      channel,\n                    });\n                  }}\n                />\n                <MessagesOptions \n                  visible={messagesOptionsVisible} \n                  setVisible={setMessagesOptionsVisible} \n                  userId={userId}\n                  currentUserId={optionsProfileId}\n                  allData={allData}\n                  setAllData={setAllData}\n                />\n              </View>\n            </Chat>\n          </SafeAreaView>\n        );\n      } else {\n        return (\n          <AddVideo />\n        )\n      }\n    } else {\n      return null; \n    }\n  }\n\n  function disableHeader({text}){\n    if(text == 'ALL') {\n      setDisabled({all: true, matches: false, likes: false }); \n    } else if (text == 'MATCHES') {\n      setDisabled({all: false, matches: true, likes: false }); \n    } else if (text == 'LIKES'){\n      setDisabled({all: false, matches: false, likes: true }); \n    }\n  }\n\n  function HeaderButton({text, disabled}){\n    const textStyle = disabled ? styles.headerText: styles.disabledHeaderText;\n\n    return (\n      <TouchableOpacity onPress={() => { disableHeader({text}) }}>\n        <View>\n          <Text style={textStyle}>{text}</Text>\n        </View>\n      </TouchableOpacity>)\n  }\n\n  ChannelListScreen.navigationOptions = () => ({\n    headerTitle: () => (\n      <View style={{ paddingBottom: '1%', flexDirection: 'row', justifyContent: 'space-around', width: '100%' }}>\n          <HeaderButton text={'ALL'} disabled={disabled.all} />\n          <HeaderButton text={'MATCHES'} disabled={disabled.matches} />\n          <HeaderButton text={'LIKES'} disabled={disabled.likes} />\n      </View>\n    ),\n  });\n\n  function ChannelScreen(props){\n    const channel = props.navigation.getParam('channel'); \n\n    return (\n      <SafeAreaView>\n        <Chat client={chatClient}>\n          <Channel client={chatClient} channel={channel}>\n            <View style={{ display: 'flex', height: '100%' }}>\n              <MessageList />\n              <MessageInput />\n            </View>\n          </Channel>\n        </Chat>\n      </SafeAreaView>\n    );\n  }\n\n  ChannelScreen.navigationOptions = ({ navigation }) => { \n    const channel = navigation.getParam('channel');\n\n    const profileId = parseInt(channel.data.membersIds.filter(memberId => {\n      return memberId != userId.toString(); \n    })[0]);    \n\n    const like = enabledData.filter(like => {\n      return profileId == like.profileId; \n    });\n\n    const currentName = like[0].profileUser.firstName;\n\n    const moreOptions = () => {\n      setMessagesOptionsVisible(true); \n      setOptionsProfileId(profileId); \n    }\n\n    return {\n      title: currentName,\n      headerBackTitleVisible: false,\n      headerRight: () => (\n        <TouchableOpacity onPress={moreOptions} style={{ paddingRight: 20}}>\n          <Ionicons name=\"ios-more\" size={30} color={colors.primaryBlack}/>\n        </TouchableOpacity>      \n      )\n    };\n  };\n\n  const RootStack = createStackNavigator(\n    {\n      ChannelList: {\n        screen: ChannelListScreen\n      }, \n      Channel: {\n        screen: ChannelScreen\n      }\n    }, \n    {\n      initialRouteName: 'ChannelList'\n    }\n  )\n\n  const AppContainer = createAppContainer(RootStack);\n\n    return (\n      <AppContainer />\n    )\n}\n\nconst windowWidth = Math.round(Dimensions.get('window').width);\nconst thumbnailWidth = windowWidth * 0.32; \nconst thumbnailHeight = windowWidth * 0.4; \n\n\nconst styles = StyleSheet.create({\n  videoSectionStyle: { flex: 1, flexDirection: 'row' },\n  thumbnailPaddingStyle: { padding: '0.2%'}, \n  thumbnailDimensions: { width: thumbnailWidth, height: thumbnailHeight },\n  headerText: {\n    margin: 8, textAlign: 'center', fontSize: 15, fontWeight: 'bold', color: colors.primaryPurple\n  },\n  disabledHeaderText: {\n    margin: 8, textAlign: 'center', fontSize: 15, color: colors.secondaryGray\n  },\n  addVideoContainer: { \n    backgroundColor: colors.primaryWhite, \n    borderRadius: 5,\n    width: 250,\n    height: 50, \n    justifyContent: 'center', \n    alignItems: 'center'\n  }, \n  addVideoText: {\n      fontSize: 17,\n      color: colors.primaryPurple,\n      fontWeight: 'bold'\n  }\n});"]},"metadata":{},"sourceType":"module"}