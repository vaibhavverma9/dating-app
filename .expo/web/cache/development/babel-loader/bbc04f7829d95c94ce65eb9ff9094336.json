{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/Users/vaibhavverma9/Desktop/realtalk-app/dating-app/AppNavigator.tsx\";\nimport React, { useState, useEffect, useContext } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport { useDoormanUser } from 'react-native-doorman';\nimport { UserIdContext } from \"./app/utils/context/UserIdContext\";\nimport { GET_USERS_BY_UID, INSERT_USER } from \"./app/utils/graphql/GraphqlClient\";\nimport { useMutation, useLazyQuery } from '@apollo/client';\nimport TabStack from \"./app/stacks/TabStack\";\nimport OnboardingStack from \"./app/stacks/OnboardingStack\";\nimport { colors } from \"./app/styles/colors\";\nimport { VideoCountContextProvider } from \"./app/utils/context/VideoCountContext\";\nimport * as Sentry from 'sentry-expo';\nexport default function AppNavigator() {\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      onboarded = _useState2[0],\n      setOnboarded = _useState2[1];\n\n  var _useDoormanUser = useDoormanUser(),\n      uid = _useDoormanUser.uid,\n      phoneNumber = _useDoormanUser.phoneNumber;\n\n  var _useContext = useContext(UserIdContext),\n      _useContext2 = _slicedToArray(_useContext, 2),\n      userId = _useContext2[0],\n      setUserId = _useContext2[1];\n\n  var _useMutation = useMutation(INSERT_USER),\n      _useMutation2 = _slicedToArray(_useMutation, 2),\n      insertUser = _useMutation2[0],\n      insertUserData = _useMutation2[1].insertUserData;\n\n  var _useLazyQuery = useLazyQuery(GET_USERS_BY_UID, {\n    onError: function onError(error) {\n      console.log(\"error\", error);\n      Sentry.captureException(error);\n    },\n    onCompleted: function onCompleted(usersByUid) {\n      initUser(usersByUid);\n    }\n  }),\n      _useLazyQuery2 = _slicedToArray(_useLazyQuery, 2),\n      getUsersByUid = _useLazyQuery2[0],\n      usersByUid = _useLazyQuery2[1].data;\n\n  useEffect(function () {\n    getUsersByUid({\n      variables: {\n        uid: uid\n      }\n    });\n  }, [uid, getUsersByUid]);\n\n  function initUser(usersByUid) {\n    return _regeneratorRuntime.async(function initUser$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (usersByUid.users.length == 0) {\n              insertUser({\n                variables: {\n                  uid: uid,\n                  phoneNumber: phoneNumber\n                }\n              }).then(function (insertUserResponse) {\n                setUserId(insertUserResponse.data.insert_users.returning[0].id);\n                setOnboarded(false);\n              }).catch(function (error) {\n                Sentry.captureException(error);\n                setUserId(0);\n                setOnboarded(true);\n              });\n            } else {\n              setUserId(usersByUid.users[0].id);\n              setOnboarded(usersByUid.users[0].onboarded);\n            }\n\n          case 1:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  if (onboarded == false) {\n    return React.createElement(OnboardingStack, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 9\n      }\n    });\n  } else if (onboarded == true) {\n    return React.createElement(VideoCountContextProvider, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }\n    }, React.createElement(TabStack, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 11\n      }\n    }));\n  } else {\n    return React.createElement(View, {\n      style: {\n        flex: 1,\n        backgroundColor: colors.primaryPurple,\n        justifyContent: 'center',\n        alignItems: 'center'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 7\n      }\n    }, React.createElement(Text, {\n      style: {\n        color: '#eee'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 9\n      }\n    }, \"App is loading, just a sec...\"));\n  }\n}","map":{"version":3,"sources":["/Users/vaibhavverma9/Desktop/realtalk-app/dating-app/AppNavigator.tsx"],"names":["React","useState","useEffect","useContext","useDoormanUser","UserIdContext","GET_USERS_BY_UID","INSERT_USER","useMutation","useLazyQuery","TabStack","OnboardingStack","colors","VideoCountContextProvider","Sentry","AppNavigator","onboarded","setOnboarded","uid","phoneNumber","userId","setUserId","insertUser","insertUserData","onError","error","console","log","captureException","onCompleted","usersByUid","initUser","getUsersByUid","data","variables","users","length","then","insertUserResponse","insert_users","returning","id","catch","flex","backgroundColor","primaryPurple","justifyContent","alignItems","color"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\nimport { View, Text } from 'react-native'; \nimport { useDoormanUser } from 'react-native-doorman'\nimport { UserIdContext } from './app/utils/context/UserIdContext'\nimport { GET_USERS_BY_UID, INSERT_USER } from './app/utils/graphql/GraphqlClient';\nimport { useMutation, useLazyQuery } from '@apollo/client';\nimport TabStack from './app/stacks/TabStack'; \nimport OnboardingStack from './app/stacks/OnboardingStack';\n// import { LocationContext } from './app/utils/context/LocationContext';\nimport { colors } from './app/styles/colors';\nimport { VideoCountContextProvider } from './app/utils/context/VideoCountContext';\nimport * as Sentry from 'sentry-expo'; \n\nexport default function AppNavigator(){\n\n  const [onboarded, setOnboarded] = useState(null);\n  const { uid, phoneNumber } = useDoormanUser();\n  const [userId, setUserId] = useContext(UserIdContext);\n  // const [location, setLocation] = useContext(LocationContext); \n  const [insertUser, { insertUserData }] = useMutation(INSERT_USER); \n\n  const [getUsersByUid, { data: usersByUid }] = useLazyQuery(GET_USERS_BY_UID,\n    {\n      onError: (error) => {\n        console.log(\"error\", error); \n        Sentry.captureException(error); \n      }, \n      onCompleted: (usersByUid) => {\n        initUser(usersByUid); \n      }\n    })\n\n  useEffect(() => {\n    getUsersByUid({ variables: { uid }});\n  }, [uid, getUsersByUid]);\n\n  async function initUser(usersByUid){\n    if(usersByUid.users.length == 0){\n      insertUser({variables: { uid, phoneNumber }})\n      .then(insertUserResponse => { \n        setUserId(insertUserResponse.data.insert_users.returning[0].id); \n        setOnboarded(false); \n        // _storeUserId(insertUserResponse.data.insert_users.returning[0].id); \n        // _storeDoormanUid(uid); \n        // _storeOnboarded(false); \n      })\n      .catch(error => {\n        Sentry.captureException(error);\n        setUserId(0);\n        setOnboarded(true); \n      })\n    } else {\n      setUserId(usersByUid.users[0].id);\n      setOnboarded(usersByUid.users[0].onboarded)\n\n      // _storeUserId(usersByUid.users[0].id);\n      // _storeDoormanUid(uid); \n      // _storeOnboarded(usersByUid.users[0].onboarded); \n\n      // if(usersByUid.users[0].location){\n      //   _storeLatitude(usersByUid.users[0].location.coordinates[0]); \n      //   _storeLongitude(usersByUid.users[0].location.coordinates[1]); \n        // (getUsersResponse.data.users[0].location.coordinates[1]);  \n      // }\n    }\n  }\n\n  if (onboarded == false){\n    return (\n      // <UserIdContextProvider>\n        <OnboardingStack />\n      // {/* </UserIdContextProvider> */}\n    )\n  } else if (onboarded == true){\n    return (      \n      // <UserIdContextProvider>\n        <VideoCountContextProvider>\n          <TabStack />\n        </VideoCountContextProvider>\n      // </UserIdContextProvider>\n\n    )\n  } else {\n    return (\n      <View style={{ flex: 1, backgroundColor: colors.primaryPurple, justifyContent: 'center', alignItems: 'center' }}>\n        <Text style={{ color: '#eee'}}>App is loading, just a sec...</Text>\n     </View>     \n    ) \n  }\n}"]},"metadata":{},"sourceType":"module"}